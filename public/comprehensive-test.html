<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì†Œê°• ì¢…í•© í…ŒìŠ¤íŠ¸ í˜ì´ì§€</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
            border-bottom: 3px solid #007bff;
            padding-bottom: 15px;
        }
        h2 {
            color: #007bff;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background-color: #fafafa;
        }
        .button-group {
            display: flex;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
        }
        button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        .btn-primary {
            background-color: #007bff;
            color: white;
        }
        .btn-primary:hover {
            background-color: #0056b3;
        }
        .btn-success {
            background-color: #28a745;
            color: white;
        }
        .btn-success:hover {
            background-color: #1e7e34;
        }
        .btn-warning {
            background-color: #ffc107;
            color: black;
        }
        .btn-warning:hover {
            background-color: #e0a800;
        }
        .btn-danger {
            background-color: #dc3545;
            color: white;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        input, select, textarea {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            margin: 5px;
            width: 200px;
        }
        textarea {
            width: 100%;
            height: 100px;
            resize: vertical;
        }
        .result-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        .success {
            border-left: 4px solid #28a745;
            background-color: #d4edda;
        }
        .error {
            border-left: 4px solid #dc3545;
            background-color: #f8d7da;
        }
        .info {
            border-left: 4px solid #007bff;
            background-color: #d1ecf1;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-connected {
            background-color: #28a745;
        }
        .status-disconnected {
            background-color: #dc3545;
        }
        .status-connecting {
            background-color: #ffc107;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        .feature-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            background: white;
        }
        .feature-status {
            float: right;
            padding: 4px 8px;
            border-radius: 4px;
            color: white;
            font-size: 12px;
        }
        .implemented {
            background-color: #28a745;
        }
        .partial {
            background-color: #ffc107;
            color: black;
        }
        .todo {
            background-color: #6c757d;
        }
        .test-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        #eventLog {
            height: 200px;
            overflow-y: auto;
            font-size: 11px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ® ì†Œê°• (SoGang) ì¢…í•© í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ</h1>
        <p>The Gang ë©€í‹°í”Œë ˆì´ì–´ ì¹´ë“œ ê²Œì„ì˜ ëª¨ë“  ê¸°ëŠ¥ì„ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ì¢…í•© í…ŒìŠ¤íŠ¸ í˜ì´ì§€ì…ë‹ˆë‹¤.</p>
        
        <div style="text-align: center; margin: 20px 0;">
            <span class="status-indicator" id="connectionStatus"></span>
            <span id="connectionText">ì—°ê²° ëŒ€ê¸° ì¤‘...</span>
        </div>
    </div>

    <!-- ì‹œìŠ¤í…œ ìƒíƒœ -->
    <div class="container">
        <h2>ğŸ“Š ì‹œìŠ¤í…œ ìƒíƒœ</h2>
        <div class="test-grid">
            <div class="feature-card">
                <span class="feature-status implemented">ì™„ë£Œ</span>
                <h3>í•µì‹¬ ê²Œì„ ë¡œì§</h3>
                <p>4ë¼ìš´ë“œ ê²Œì„ ì§„í–‰, ì¹© ì‹œìŠ¤í…œ, ì‡¼ë‹¤ìš´ ë¡œì§</p>
            </div>
            <div class="feature-card">
                <span class="feature-status implemented">ì™„ë£Œ</span>
                <h3>Advanced Mode</h3>
                <p>ì±Œë¦°ì§€/ìŠ¤í˜ì…œë¦¬ìŠ¤íŠ¸ ì¹´ë“œ, Professional/Master Thief</p>
            </div>
            <div class="feature-card">
                <span class="feature-status implemented">ì™„ë£Œ</span>
                <h3>í¬ì»¤ í•¸ë“œ í‰ê°€</h3>
                <p>ì •í™•í•œ í•¸ë“œ ë­í‚¹, True Tie ì²˜ë¦¬, í‚¥ì»¤ ì¹´ë“œ</p>
            </div>
            <div class="feature-card">
                <span class="feature-status implemented">ì™„ë£Œ</span>
                <h3>í†µê³„ & íˆìŠ¤í† ë¦¬</h3>
                <p>ê²Œì„ ê¸°ë¡, ì‚¬ìš©ì í†µê³„, ë¦¬ë”ë³´ë“œ</p>
            </div>
            <div class="feature-card">
                <span class="feature-status implemented">ì™„ë£Œ</span>
                <h3>ì‚¬ìš©ì ì‹œìŠ¤í…œ</h3>
                <p>í”„ë¡œí•„, ì¹œêµ¬, ì°¨ë‹¨, ì‹ ê³  ê¸°ëŠ¥</p>
            </div>
            <div class="feature-card">
                <span class="feature-status implemented">ì™„ë£Œ</span>
                <h3>ì±„íŒ… ì‹œìŠ¤í…œ</h3>
                <p>ê²Œì„/ë¡œë¹„/ê°œì¸ ì±„íŒ…, ê·œì¹™ ì¤€ìˆ˜ í•„í„°ë§</p>
            </div>
            <div class="feature-card">
                <span class="feature-status implemented">ì™„ë£Œ</span>
                <h3>ë¦¬í”Œë ˆì´ ì‹œìŠ¤í…œ</h3>
                <p>ê²Œì„ ê¸°ë¡, ì¬ìƒ, ë¶„ì„, í•˜ì´ë¼ì´íŠ¸</p>
            </div>
            <div class="feature-card">
                <span class="feature-status partial">ì§„í–‰ì¤‘</span>
                <h3>ì—°ê²° ê´€ë¦¬</h3>
                <p>ì¬ì—°ê²°, ë©”ëª¨ë¦¬ ìµœì í™”, ë²„ê·¸ ìˆ˜ì •</p>
            </div>
        </div>
    </div>

    <!-- ê¸°ë³¸ ì—°ê²° í…ŒìŠ¤íŠ¸ -->
    <div class="container">
        <h2>ğŸ”Œ ì—°ê²° í…ŒìŠ¤íŠ¸</h2>
        <div class="test-section">
            <div class="button-group">
                <button class="btn-primary" onclick="connectToServer()">ì„œë²„ ì—°ê²°</button>
                <button class="btn-danger" onclick="disconnectFromServer()">ì—°ê²° í•´ì œ</button>
                <button class="btn-success" onclick="registerUser()">ì‚¬ìš©ì ë“±ë¡</button>
                <button class="btn-warning" onclick="sendHeartbeat()">Heartbeat</button>
            </div>
            <div>
                <input type="text" id="testUsername" placeholder="í…ŒìŠ¤íŠ¸ ì‚¬ìš©ìëª…" value="TestUser">
            </div>
            <div class="result-box" id="connectionResult"></div>
        </div>
    </div>

    <!-- ê²Œì„ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ -->
    <div class="container">
        <h2>ğŸ¯ ê²Œì„ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸</h2>
        <div class="test-grid">
            <!-- ë°© ê´€ë¦¬ -->
            <div class="test-section">
                <h3>ë°© ê´€ë¦¬</h3>
                <div class="button-group">
                    <button class="btn-primary" onclick="createRoom()">ë°© ìƒì„±</button>
                    <button class="btn-success" onclick="joinRoom()">ë°© ì…ì¥</button>
                    <button class="btn-warning" onclick="getRoomList()">ë°© ëª©ë¡</button>
                    <button class="btn-danger" onclick="leaveRoom()">ë°© ë‚˜ê°€ê¸°</button>
                </div>
                <input type="text" id="roomName" placeholder="ë°© ì´ë¦„" value="í…ŒìŠ¤íŠ¸ë°©">
                <input type="text" id="roomId" placeholder="ë°© ID">
                <div class="result-box" id="roomResult"></div>
            </div>

            <!-- ê²Œì„ ì§„í–‰ -->
            <div class="test-section">
                <h3>ê²Œì„ ì§„í–‰</h3>
                <div class="button-group">
                    <button class="btn-primary" onclick="startGame()">ê²Œì„ ì‹œì‘</button>
                    <button class="btn-success" onclick="playerAction('pass')">íŒ¨ìŠ¤</button>
                    <button class="btn-warning" onclick="playerAction('takeFromCenter')">ì¹© ê°€ì ¸ì˜¤ê¸°</button>
                    <button class="btn-danger" onclick="endGame()">ê²Œì„ ì¢…ë£Œ</button>
                </div>
                <select id="gameMode">
                    <option value="BASIC">Basic</option>
                    <option value="ADVANCED">Advanced</option>
                    <option value="PROFESSIONAL">Professional</option>
                    <option value="MASTER_THIEF">Master Thief</option>
                </select>
                <div class="result-box" id="gameResult"></div>
            </div>

            <!-- ì±„íŒ… í…ŒìŠ¤íŠ¸ -->
            <div class="test-section">
                <h3>ì±„íŒ… ì‹œìŠ¤í…œ</h3>
                <div class="button-group">
                    <button class="btn-primary" onclick="sendGameChat()">ê²Œì„ ì±„íŒ…</button>
                    <button class="btn-success" onclick="sendLobbyChat()">ë¡œë¹„ ì±„íŒ…</button>
                    <button class="btn-warning" onclick="sendPrivateMessage()">ê°œì¸ ë©”ì‹œì§€</button>
                </div>
                <input type="text" id="chatMessage" placeholder="ë©”ì‹œì§€ ì…ë ¥" value="ì•ˆë…•í•˜ì„¸ìš”!">
                <input type="text" id="privateTo" placeholder="ë°›ëŠ” ì‚¬ëŒ" value="TestUser2">
                <div class="result-box" id="chatResult"></div>
            </div>

            <!-- ì¹œêµ¬ ì‹œìŠ¤í…œ -->
            <div class="test-section">
                <h3>ì¹œêµ¬ ì‹œìŠ¤í…œ</h3>
                <div class="button-group">
                    <button class="btn-primary" onclick="sendFriendRequest()">ì¹œêµ¬ ìš”ì²­</button>
                    <button class="btn-success" onclick="acceptFriendRequest()">ìš”ì²­ ìˆ˜ë½</button>
                    <button class="btn-warning" onclick="getFriendList()">ì¹œêµ¬ ëª©ë¡</button>
                    <button class="btn-danger" onclick="sendGameInvite()">ê²Œì„ ì´ˆëŒ€</button>
                </div>
                <input type="text" id="friendUsername" placeholder="ì¹œêµ¬ ì‚¬ìš©ìëª…" value="TestFriend">
                <div class="result-box" id="friendResult"></div>
            </div>

            <!-- í†µê³„ ë° í”„ë¡œí•„ -->
            <div class="test-section">
                <h3>í†µê³„ & í”„ë¡œí•„</h3>
                <div class="button-group">
                    <button class="btn-primary" onclick="getGameStats()">ê²Œì„ í†µê³„</button>
                    <button class="btn-success" onclick="getUserProfile()">ì‚¬ìš©ì í”„ë¡œí•„</button>
                    <button class="btn-warning" onclick="getLeaderboard()">ë¦¬ë”ë³´ë“œ</button>
                    <button class="btn-danger" onclick="updateProfile()">í”„ë¡œí•„ ì—…ë°ì´íŠ¸</button>
                </div>
                <div class="result-box" id="statsResult"></div>
            </div>

            <!-- ë¦¬í”Œë ˆì´ ì‹œìŠ¤í…œ -->
            <div class="test-section">
                <h3>ë¦¬í”Œë ˆì´ ì‹œìŠ¤í…œ</h3>
                <div class="button-group">
                    <button class="btn-primary" onclick="getReplayList()">ë¦¬í”Œë ˆì´ ëª©ë¡</button>
                    <button class="btn-success" onclick="getReplayDetails()">ë¦¬í”Œë ˆì´ ìƒì„¸</button>
                    <button class="btn-warning" onclick="analyzeReplay()">ë¦¬í”Œë ˆì´ ë¶„ì„</button>
                </div>
                <input type="text" id="replayId" placeholder="ë¦¬í”Œë ˆì´ ID">
                <div class="result-box" id="replayResult"></div>
            </div>
        </div>
    </div>

    <!-- ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ -->
    <div class="container">
        <h2>âš¡ ì„±ëŠ¥ ë° ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸</h2>
        <div class="test-section">
            <div class="button-group">
                <button class="btn-primary" onclick="startStressTest()">ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ ì‹œì‘</button>
                <button class="btn-warning" onclick="memoryTest()">ë©”ëª¨ë¦¬ í…ŒìŠ¤íŠ¸</button>
                <button class="btn-success" onclick="connectionTest()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
                <button class="btn-danger" onclick="stopAllTests()">ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¤‘ì§€</button>
            </div>
            <div>
                <input type="number" id="testUsers" placeholder="ë™ì‹œ ì‚¬ìš©ì ìˆ˜" value="10" min="1" max="100">
                <input type="number" id="testDuration" placeholder="í…ŒìŠ¤íŠ¸ ì‹œê°„(ì´ˆ)" value="60" min="10" max="600">
            </div>
            <div class="result-box" id="stressResult"></div>
        </div>
    </div>

    <!-- ì‹¤ì‹œê°„ ë¡œê·¸ -->
    <div class="container">
        <h2>ğŸ“ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ë¡œê·¸</h2>
        <div class="test-section">
            <div class="button-group">
                <button class="btn-primary" onclick="clearLog()">ë¡œê·¸ ì§€ìš°ê¸°</button>
                <button class="btn-warning" onclick="toggleLogLevel()">ë¡œê·¸ ë ˆë²¨ ë³€ê²½</button>
                <button class="btn-success" onclick="exportLog()">ë¡œê·¸ ë‚´ë³´ë‚´ê¸°</button>
            </div>
            <div class="result-box" id="eventLog"></div>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        let socket = null;
        let isConnected = false;
        let currentUser = null;
        let stressTestInterval = null;
        let logLevel = 'all'; // 'error', 'info', 'all'

        // ì—°ê²° ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateConnectionStatus(status, text) {
            const indicator = document.getElementById('connectionStatus');
            const textElement = document.getElementById('connectionText');
            
            indicator.className = `status-indicator status-${status}`;
            textElement.textContent = text;
        }

        // ë¡œê·¸ ì¶”ê°€
        function addLog(message, type = 'info') {
            const logElement = document.getElementById('eventLog');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${type.toUpperCase()}: ${message}\\n`;
            
            logElement.textContent += logEntry;
            logElement.scrollTop = logElement.scrollHeight;
            
            // ë¡œê·¸ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ì˜¤ë˜ëœ ê²ƒë¶€í„° ì‚­ì œ
            const lines = logElement.textContent.split('\\n');
            if (lines.length > 1000) {
                logElement.textContent = lines.slice(-500).join('\\n');
            }
        }

        // ê²°ê³¼ í‘œì‹œ
        function showResult(elementId, data, type = 'info') {
            const element = document.getElementById(elementId);
            element.className = `result-box ${type}`;
            element.textContent = typeof data === 'object' ? JSON.stringify(data, null, 2) : data;
            
            addLog(`Result (${elementId}): ${typeof data === 'object' ? JSON.stringify(data) : data}`, type);
        }

        // ì„œë²„ ì—°ê²°
        function connectToServer() {
            if (socket) {
                socket.disconnect();
            }

            updateConnectionStatus('connecting', 'ì—°ê²° ì¤‘...');
            
            socket = io();
            
            socket.on('connect', () => {
                isConnected = true;
                updateConnectionStatus('connected', 'ì—°ê²°ë¨');
                showResult('connectionResult', 'ì„œë²„ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                addLog('ì„œë²„ ì—°ê²° ì„±ê³µ', 'info');
            });

            socket.on('disconnect', () => {
                isConnected = false;
                updateConnectionStatus('disconnected', 'ì—°ê²° ëŠê¹€');
                showResult('connectionResult', 'ì„œë²„ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤.', 'error');
                addLog('ì„œë²„ ì—°ê²° ëŠì–´ì§', 'error');
            });

            socket.on('error', (error) => {
                showResult('connectionResult', `ì˜¤ë¥˜: ${error.message}`, 'error');
                addLog(`ì†Œì¼“ ì˜¤ë¥˜: ${error.message}`, 'error');
            });

            // ê²Œì„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë“¤
            setupGameEventListeners();
        }

        // ê²Œì„ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
        function setupGameEventListeners() {
            // ê²Œì„ ì´ë²¤íŠ¸ë“¤
            socket.on('gameStarted', (data) => {
                showResult('gameResult', data, 'success');
                addLog(`ê²Œì„ ì‹œì‘: ${data.gameMode} ëª¨ë“œ`, 'info');
            });

            socket.on('round1Started', (data) => {
                showResult('gameResult', data, 'info');
                addLog('1ë¼ìš´ë“œ ì‹œì‘', 'info');
            });

            socket.on('showdownResult', (data) => {
                showResult('gameResult', data, data.heistSuccess ? 'success' : 'error');
                addLog(`ì‡¼ë‹¤ìš´: ${data.heistSuccess ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'}`, 'info');
            });

            // ì±„íŒ… ì´ë²¤íŠ¸ë“¤
            socket.on('gameChatMessage', (data) => {
                showResult('chatResult', data, 'info');
                addLog(`ê²Œì„ ì±„íŒ…: ${data.username}: ${data.message}`, 'info');
            });

            socket.on('lobbyChatMessage', (data) => {
                showResult('chatResult', data, 'info');
                addLog(`ë¡œë¹„ ì±„íŒ…: ${data.username}: ${data.message}`, 'info');
            });

            socket.on('privateMessageReceived', (data) => {
                showResult('chatResult', data, 'info');
                addLog(`ê°œì¸ ë©”ì‹œì§€: ${data.from}: ${data.message}`, 'info');
            });

            // ì¹œêµ¬ ì´ë²¤íŠ¸ë“¤
            socket.on('friendRequestReceived', (data) => {
                showResult('friendResult', data, 'info');
                addLog(`ì¹œêµ¬ ìš”ì²­: ${data.from}`, 'info');
            });

            socket.on('gameInviteReceived', (data) => {
                showResult('friendResult', data, 'info');
                addLog(`ê²Œì„ ì´ˆëŒ€: ${data.from} -> ${data.roomName}`, 'info');
            });

            // í†µê³„ ì´ë²¤íŠ¸ë“¤
            socket.on('gameStats', (data) => {
                showResult('statsResult', data, 'success');
                addLog('ê²Œì„ í†µê³„ ì¡°íšŒ ì™„ë£Œ', 'info');
            });

            socket.on('userProfile', (data) => {
                showResult('statsResult', data, 'success');
                addLog(`í”„ë¡œí•„ ì¡°íšŒ: ${data.username}`, 'info');
            });

            // ë¦¬í”Œë ˆì´ ì´ë²¤íŠ¸ë“¤
            socket.on('replayList', (data) => {
                showResult('replayResult', data, 'success');
                addLog(`ë¦¬í”Œë ˆì´ ëª©ë¡: ${data.length}ê°œ`, 'info');
            });
        }

        // ì—°ê²° í•´ì œ
        function disconnectFromServer() {
            if (socket) {
                socket.disconnect();
                socket = null;
            }
        }

        // ì‚¬ìš©ì ë“±ë¡
        function registerUser() {
            const username = document.getElementById('testUsername').value || 'TestUser';
            if (socket && isConnected) {
                socket.emit('registerUser', username);
                currentUser = username;
                showResult('connectionResult', `ì‚¬ìš©ì ë“±ë¡: ${username}`, 'success');
            }
        }

        // Heartbeat ì „ì†¡
        function sendHeartbeat() {
            if (socket && isConnected) {
                socket.emit('heartbeat');
                showResult('connectionResult', 'Heartbeat ì „ì†¡', 'info');
            }
        }

        // ë°© ìƒì„±
        function createRoom() {
            const roomName = document.getElementById('roomName').value || 'í…ŒìŠ¤íŠ¸ë°©';
            const gameMode = document.getElementById('gameMode').value;
            
            if (socket && isConnected) {
                socket.emit('createRoom', { 
                    name: roomName, 
                    maxPlayers: 6,
                    gameMode: gameMode
                });
            }
        }

        // ë°© ì…ì¥
        function joinRoom() {
            const roomId = document.getElementById('roomId').value;
            if (socket && isConnected && roomId) {
                socket.emit('joinRoom', roomId);
            }
        }

        // ë°© ëª©ë¡ ì¡°íšŒ
        function getRoomList() {
            if (socket && isConnected) {
                socket.emit('getRoomList');
            }
        }

        // ê²Œì„ ì‹œì‘
        function startGame() {
            const roomId = document.getElementById('roomId').value;
            if (socket && isConnected && roomId) {
                socket.emit('startGame', { roomId });
            }
        }

        // í”Œë ˆì´ì–´ ì•¡ì…˜
        function playerAction(action) {
            const roomId = document.getElementById('roomId').value;
            if (socket && isConnected && roomId) {
                socket.emit('playerAction', { 
                    roomId, 
                    action,
                    targetId: action === 'takeFromCenter' ? 'center1' : null
                });
            }
        }

        // ì±„íŒ… ë©”ì‹œì§€ ì „ì†¡
        function sendGameChat() {
            const roomId = document.getElementById('roomId').value;
            const message = document.getElementById('chatMessage').value;
            if (socket && isConnected && roomId && message) {
                socket.emit('gameChatMessage', { roomId, message });
            }
        }

        function sendLobbyChat() {
            const message = document.getElementById('chatMessage').value;
            if (socket && isConnected && message) {
                socket.emit('lobbyChatMessage', { message });
            }
        }

        function sendPrivateMessage() {
            const toUsername = document.getElementById('privateTo').value;
            const message = document.getElementById('chatMessage').value;
            if (socket && isConnected && toUsername && message) {
                socket.emit('sendPrivateMessage', { toUsername, message });
            }
        }

        // ì¹œêµ¬ ìš”ì²­
        function sendFriendRequest() {
            const toUsername = document.getElementById('friendUsername').value;
            if (socket && isConnected && toUsername) {
                socket.emit('sendFriendRequest', { toUsername });
            }
        }

        // ê²Œì„ í†µê³„ ì¡°íšŒ
        function getGameStats() {
            if (socket && isConnected) {
                socket.emit('getGameStats');
            }
        }

        // ë¦¬í”Œë ˆì´ ëª©ë¡ ì¡°íšŒ
        function getReplayList() {
            if (socket && isConnected) {
                socket.emit('getReplayList', { limit: 10, offset: 0 });
            }
        }

        // ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸
        function startStressTest() {
            const userCount = parseInt(document.getElementById('testUsers').value) || 10;
            const duration = parseInt(document.getElementById('testDuration').value) || 60;
            
            showResult('stressResult', `ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ ì‹œì‘: ${userCount}ëª… ì‚¬ìš©ì, ${duration}ì´ˆ`, 'info');
            
            let testCounter = 0;
            stressTestInterval = setInterval(() => {
                // ëœë¤ ì•¡ì…˜ ì‹¤í–‰
                const actions = ['createRoom', 'joinRoom', 'sendLobbyChat', 'getGameStats'];
                const randomAction = actions[Math.floor(Math.random() * actions.length)];
                
                try {
                    switch(randomAction) {
                        case 'createRoom':
                            if (socket && isConnected) {
                                socket.emit('createRoom', { 
                                    name: `ìŠ¤íŠ¸ë ˆìŠ¤í…ŒìŠ¤íŠ¸ë°©_${testCounter}`, 
                                    maxPlayers: 6 
                                });
                            }
                            break;
                        case 'sendLobbyChat':
                            if (socket && isConnected) {
                                socket.emit('lobbyChatMessage', { 
                                    message: `ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ ë©”ì‹œì§€ ${testCounter}` 
                                });
                            }
                            break;
                        case 'getGameStats':
                            if (socket && isConnected) {
                                socket.emit('getGameStats');
                            }
                            break;
                    }
                } catch (error) {
                    addLog(`ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ ì˜¤ë¥˜: ${error.message}`, 'error');
                }
                
                testCounter++;
            }, 1000);
            
            // ì§€ì •ëœ ì‹œê°„ í›„ í…ŒìŠ¤íŠ¸ ì¤‘ì§€
            setTimeout(() => {
                stopAllTests();
                showResult('stressResult', `ìŠ¤íŠ¸ë ˆìŠ¤ í…ŒìŠ¤íŠ¸ ì™„ë£Œ: ${testCounter}ê°œ ì•¡ì…˜ ì‹¤í–‰`, 'success');
            }, duration * 1000);
        }

        // ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¤‘ì§€
        function stopAllTests() {
            if (stressTestInterval) {
                clearInterval(stressTestInterval);
                stressTestInterval = null;
            }
        }

        // ë¡œê·¸ ì§€ìš°ê¸°
        function clearLog() {
            document.getElementById('eventLog').textContent = '';
        }

        // ë¡œê·¸ ë‚´ë³´ë‚´ê¸°
        function exportLog() {
            const logContent = document.getElementById('eventLog').textContent;
            const blob = new Blob([logContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `sogang-test-log-${new Date().toISOString()}.txt`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì—°ê²°
        window.onload = function() {
            addLog('í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ', 'info');
            // connectToServer(); // ìë™ ì—°ê²°ì„ ì›í•˜ë©´ ì£¼ì„ í•´ì œ
        };

        // í˜ì´ì§€ ì–¸ë¡œë“œ ì‹œ ì •ë¦¬
        window.onbeforeunload = function() {
            stopAllTests();
            if (socket) {
                socket.disconnect();
            }
        };
    </script>
</body>
</html>